<!-- 安全与权限设置子页面 -->
<div class="bg-white/10 backdrop-blur-sm rounded-xl p-6">
    <div class="mb-6">
        <h2 class="text-xl font-bold text-white">安全与权限</h2>
        <p class="text-gray-300">用户权限与系统安全配置</p>
    </div>

    <form>
        <!-- 系统安全 -->
        <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">系统安全设置</h3>
            <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
                <div>
                    <label class="block text-sm font-medium text-gray-200 mb-1">密码策略</label>
                    <select class="w-full px-3 py-2 bg-white/20 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-white">
                        <option>基本 (至少8位)</option>
                        <option selected>标准 (至少8位，含大小写和数字)</option>
                        <option>高强度 (至少12位，含大小写、数字和特殊符号)</option>
                        <option>自定义</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-200 mb-1">密码过期时间</label>
                    <select class="w-full px-3 py-2 bg-white/20 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-white">
                        <option>30天</option>
                        <option selected>90天</option>
                        <option>180天</option>
                        <option>365天</option>
                        <option>永不过期</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-200 mb-1">会话超时时间</label>
                    <div class="flex items-center">
                        <input type="number" value="30" min="5" max="1440" class="w-24 px-3 py-2 bg-white/20 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-white">
                        <span class="ml-2 text-sm text-gray-300">分钟</span>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-200 mb-1">登录失败锁定</label>
                    <div class="flex items-center">
                        <span class="text-sm text-gray-300 mr-2">连续</span>
                        <input type="number" value="5" min="1" max="10" class="w-16 px-3 py-2 bg-white/20 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-white">
                        <span class="mx-2 text-sm text-gray-300">次失败后锁定</span>
                        <input type="number" value="30" min="5" max="1440" class="w-16 px-3 py-2 bg-white/20 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-white">
                        <span class="ml-2 text-sm text-gray-300">分钟</span>
                    </div>
                </div>
            </div>
            <div class="mt-4 space-y-4">
                <div class="flex items-center">
                    <input type="checkbox" id="two-factor" checked class="w-4 h-4 rounded bg-white/20 border-gray-600">
                    <label for="two-factor" class="ml-2 text-sm font-medium text-gray-200">启用双因素认证 (2FA)</label>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="secure-session" checked class="w-4 h-4 rounded bg-white/20 border-gray-600">
                    <label for="secure-session" class="ml-2 text-sm font-medium text-gray-200">启用安全会话 (HTTPS Only)</label>
                </div>
            </div>
        </div>

        <!-- 用户权限 -->
        <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">用户权限管理</h3>
            <div class="space-y-4">
                <div class="flex items-center">
                    <input type="checkbox" id="role-based" checked class="w-4 h-4 rounded bg-white/20 border-gray-600">
                    <label for="role-based" class="ml-2 text-sm font-medium text-gray-200">启用基于角色的权限控制</label>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-200 mb-1">默认用户角色</label>
                    <select class="w-full px-3 py-2 bg-white/20 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-white">
                        <option>访客 (只读)</option>
                        <option selected>普通用户</option>
                        <option>高级用户</option>
                        <option>管理员</option>
                    </select>
                </div>
                
                <div class="mt-6">
                    <h4 class="text-base font-medium text-white mb-2">角色权限矩阵</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white/5 rounded-lg">
                            <thead>
                                <tr>
                                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase tracking-wider border-b border-gray-700">功能/权限</th>
                                    <th class="px-4 py-2 text-center text-xs font-medium text-gray-300 uppercase tracking-wider border-b border-gray-700">访客</th>
                                    <th class="px-4 py-2 text-center text-xs font-medium text-gray-300 uppercase tracking-wider border-b border-gray-700">普通用户</th>
                                    <th class="px-4 py-2 text-center text-xs font-medium text-gray-300 uppercase tracking-wider border-b border-gray-700">高级用户</th>
                                    <th class="px-4 py-2 text-center text-xs font-medium text-gray-300 uppercase tracking-wider border-b border-gray-700">管理员</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="px-4 py-2 text-sm text-white border-b border-gray-700">查看文档</td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 text-sm text-white border-b border-gray-700">上传文档</td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 text-sm text-white border-b border-gray-700">智能对话</td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 text-sm text-white border-b border-gray-700">修改系统设置</td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 text-sm text-white border-b border-gray-700">用户管理</td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                    <td class="px-4 py-2 text-center border-b border-gray-700"><input type="checkbox" checked class="w-4 h-4 rounded bg-white/20 border-gray-600"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 数据安全 -->
        <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">数据安全</h3>
            <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
                <div>
                    <label class="block text-sm font-medium text-gray-200 mb-1">数据存储加密</label>
                    <select class="w-full px-3 py-2 bg-white/20 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-white">
                        <option>不加密</option>
                        <option>仅敏感字段 (AES-256)</option>
                        <option selected>全量加密 (AES-256)</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-200 mb-1">数据备份周期</label>
                    <select class="w-full px-3 py-2 bg-white/20 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-white">
                        <option>不自动备份</option>
                        <option>每日备份</option>
                        <option selected>每周备份</option>
                        <option>每月备份</option>
                    </select>
                </div>
            </div>
            <div class="mt-4 space-y-4">
                <div class="flex items-center">
                    <input type="checkbox" id="data-masking" checked class="w-4 h-4 rounded bg-white/20 border-gray-600">
                    <label for="data-masking" class="ml-2 text-sm font-medium text-gray-200">启用敏感数据掩码</label>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="data-retention" checked class="w-4 h-4 rounded bg-white/20 border-gray-600">
                    <label for="data-retention" class="ml-2 text-sm font-medium text-gray-200">启用数据留存策略</label>
                </div>
                <div class="pl-6">
                    <label class="block text-sm font-medium text-gray-200 mb-1">数据留存期限</label>
                    <div class="flex items-center">
                        <input type="number" value="180" min="30" max="3650" class="w-24 px-3 py-2 bg-white/20 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-white">
                        <span class="ml-2 text-sm text-gray-300">天</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 操作按钮 -->
        <div class="flex justify-end space-x-3">
            <button type="button" class="px-4 py-2 border border-gray-600 shadow-sm text-sm font-medium rounded-lg text-white bg-white/10 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-all duration-200">
                重置
            </button>
            <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-all duration-200">
                保存设置
            </button>
        </div>
    </form>
</div>

<script>
    console.log('安全与权限设置子页面已加载');
    
    // 确保页面元素已加载后才绑定事件
    setTimeout(() => {
        // 启用/禁用数据留存期限输入框
        const dataRetentionCheckbox = document.getElementById('data-retention');
        const dataRetentionInput = document.querySelector('input[type="number"][value="180"]');
        
        function updateDataRetentionState() {
            if (dataRetentionCheckbox && dataRetentionInput) {
                dataRetentionInput.disabled = !dataRetentionCheckbox.checked;
                const inputContainer = dataRetentionInput.parentNode.parentNode;
                if (dataRetentionCheckbox.checked) {
                    inputContainer.classList.remove('opacity-50');
                } else {
                    inputContainer.classList.add('opacity-50');
                }
            }
        }
        
        if (dataRetentionCheckbox) {
            updateDataRetentionState(); // 初始状态
            dataRetentionCheckbox.addEventListener('change', updateDataRetentionState);
            console.log('数据留存策略事件已绑定');
        }
        
        // 绑定表单提交事件
        const form = document.querySelector('form');
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                console.log('安全与权限设置表单提交');
                alert('安全与权限设置已保存');
            });
            console.log('表单提交事件已绑定');
        } else {
            console.error('未找到表单元素');
        }
        
        // 绑定重置按钮事件
        const resetButton = document.querySelector('button[type="button"]');
        if (resetButton) {
            resetButton.addEventListener('click', function() {
                console.log('点击了重置按钮');
                if (confirm('确定要重置所有安全与权限设置吗？这将恢复默认值。')) {
                    document.querySelector('form').reset();
                    updateDataRetentionState(); // 重新应用依赖关系
                    alert('安全与权限设置已重置为默认值');
                }
            });
            console.log('重置按钮事件已绑定');
        } else {
            console.error('未找到重置按钮');
        }
        
        console.log('安全与权限设置子页面事件绑定完成');
    }, 100);
    
    // 响应settingsTabLoaded事件
    document.addEventListener('settingsTabLoaded', function(e) {
        if (e.detail.tab === 'security') {
            console.log('检测到安全与权限设置标签页已加载事件');
        }
    });
</script> 