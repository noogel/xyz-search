<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç•…æ–‡å…¨ç´¢</title>
    <style>
        :root {
            --brand-color: #FF3366;
            --text-primary: #333;
            --text-secondary: #666;
            --bg-color: #f9f9f9;
            --card-radius: 12px;
            --shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        }

        body {
            background: var(--bg-color);
            min-height: 100vh;
        }

        /* é¡µçœ‰æ ·å¼ */
        .header {
            background: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            justify-content: space-between;
            align-items: center;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            padding: 1rem 10%;
        }

        /* æ ‡é¢˜è¡Œå®¹å™¨ */
        .header > h1,
        .header > .header-controls {
            display: flex;
            align-items: center;
        }

        /* æœç´¢æ å•ç‹¬è¡Œ */
        .header > .search-bar {
            flex: 0 0 100%; /* å¼ºåˆ¶å æ»¡æ•´è¡Œ */
            order: 2; /* æ§åˆ¶æ˜¾ç¤ºé¡ºåº */
            margin-top: 0.5rem;
        }

        /* è°ƒæ•´åŸæœ‰æœç´¢æ æ ·å¼ */
        .search-bar {
            display: flex;
            gap: 1rem;
            width: 100%;
        }
        .search-bar.hidden {
            display: none;
        }

        .menu-bar {
            display: flex;
            gap: 1.5rem;
            padding: 0.5rem 1rem;
            border-radius: 24px;
        }

        .menu-item {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            color: var(--text-primary);
            transition: all 0.2s;
        }

        .menu-item span {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .menu-item:hover {
            color: var(--brand-color);
            transform: translateY(-1px);
        }

        .user-menu {
            position: relative;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 24px;
            background: rgba(255,255,255,0.9);
            cursor: pointer;
            transition: background 0.2s;
        }

        .user-info:hover {
            background: white;
        }

        .username {
            font-weight: 500;
            color: var(--brand-color);
        }

        .logout-panel {
            position: absolute;
            right: 0;
            top: 100%;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 0.5rem;
            display: none;
            min-width: 120px;
        }

        .logout-btn {
            width: 100%;
            padding: 0.75rem;
            border: none;
            background: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 8px;
        }

        .logout-btn:hover {
            background: var(--bg-color);
            color: var(--brand-color);
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {

            .search-bar {
                order: 3; /* ç§»åŠ¨ç«¯ä¿æŒåœ¨æœ€ä¸‹æ–¹ */
                margin-top: 0;
                flex-direction: column;
            }
            .menu-bar {
                gap: 1rem;
                padding: 0.5rem;
                display: none;
            }

            .menu-item span {
                font-size: 0;
            }

            .menu-item span::before {
                font-size: 1rem;
            }

            .username {
                display: none;
            }
        }

        /* æœç´¢æ  */
        .header > div > .search-bar {
            display: flex;
            gap: 1rem;
        }

        #searchInput {
            flex: 1;
            padding: 0.8rem 1.2rem;
            border: 2px solid #eee;
            border-radius: 24px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        #searchInput:focus {
            border-color: var(--brand-color);
            outline: none;
        }

        #fileType {
            -webkit-appearance: none;  /* Safari å…³é”®ä¿®å¤ */
            -moz-appearance: none;
            appearance: none;
            padding: 0.8rem 2.5rem 0.8rem 1.2rem; /* å³ä¾§ç•™å‡ºç®­å¤´ç©ºé—´ */
            border: 2px solid #eee;
            border-radius: 24px;
            background: white url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23666666'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e") no-repeat;
            background-position: right 1rem center;
            background-size: 12px;
        }

        /* é’ˆå¯¹Safariçš„é¢å¤–ä¼˜åŒ– */
        @media not all and (min-resolution:.001dpcm) {
            @supports (-webkit-appearance:none) {
                #fileType {
                    padding-right: 3rem;
                    background-position: right 0.8rem center;
                }
            }
        }

        /* ç½‘æ ¼å†…å®¹åŒº */
        .grid-container {
            padding: 2rem 10%;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2rem;
            grid-auto-rows: minmax(100px, auto);
        }

        .card {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: transform 0.3s;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .card-content {
            padding: 1rem;
        }

        .card-title {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .card-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* æµ®å±‚æ ·å¼ */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            background: rgba(0,0,0,0.6); /* åŠ æ·±èƒŒæ™¯è‰² */
            backdrop-filter: blur(5px);
        }

        .modal {
            background: white;
            display: flex;
            flex-direction: column;
            max-width: none;
            max-height: none;
            border-radius: 18px !important; /* å¼ºåˆ¶è¦†ç›–å¯èƒ½å†²çªçš„æ ·å¼ */
            overflow: hidden; /* ç¡®ä¿å†…å®¹ä¸ç ´ååœ†è§’ */
            box-shadow: 0 12px 24px rgba(0,0,0,0.2); /* å¢å¼ºç«‹ä½“æ„Ÿ */
            width: 90vw;
            height: 90vh;
            animation: modalIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes modalIn {
            0% {
                transform: scale(0.9) translateY(30px);
                border-radius: 50px; /* åŠ¨ç”»è¿‡ç¨‹ä¸­çš„åŠ¨æ€åœ†è§’ */
                opacity: 0;
            }
            50% {
                border-radius: 36px;
            }
            100% {
                transform: scale(1) translateY(0);
                border-radius: 18px; /* æœ€ç»ˆåœ†è§’å€¼ */
                opacity: 1;
            }
        }

        /* æ·»åŠ å…³é—­åŠ¨ç”» */
        .modal-out {
            animation: modalOut 0.2s ease-in forwards;
        }

        @keyframes modalOut {
            from {
                transform: scale(1);
                opacity: 1;
            }
            to {
                transform: scale(0.95);
                opacity: 0;
            }
        }

        .modal-header,
        .modal-footer {
            padding: 0.5rem 1rem;
            background: var(--bg-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .close-btn {
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0.5rem;
        }

        .close-btn:hover {
            color: var(--brand-color);
        }

        /* è¯¦æƒ…å†…å®¹ */
        .detail-img {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: var(--card-radius);
            margin-bottom: 1rem;
        }

        .attributes-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin: 1rem 0;
        }

        .attribute-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }

        .btn-group {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn:hover {
            border-color: var(--brand-color);
            color: var(--brand-color);
        }

        .paragraph-list {
            margin-top: 1rem;
        }

        .paragraph-item {
            padding: 0.8rem;
            margin: 0.5rem 0;
            background: var(--bg-color);
            border-radius: 8px;
        }

        .highlight {
            background: #fff3b7;
            padding: 0 2px;
        }

        /* å“åº”å¼å¤„ç† */
        @media (max-width: 1200px) {
            .grid-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .grid-container {
                grid-template-columns: repeat(2, 1fr);
                padding: 1rem;
            }

            .modal {
                width: 95%;
            }

            .attributes-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .grid-container {
                grid-template-columns: 1fr;
            }

            .header > div > .search-bar {
                flex-direction: column;
            }

            .detail-img {
                height: 200px;
            }
        }

        /* é¡µè„š */
        .footer {
            padding: 2rem 10%;
            text-align: center;
            color: var(--text-secondary);
            margin-top: 3rem;
        }
    </style>
</head>
<body>
<header class="header">
    <h1>ç•…æ–‡å…¨ç´¢</h1>
    <div class="header-controls">
        <!-- åŠŸèƒ½èœå• -->
        <div class="menu-bar">
            <button class="menu-item" onclick="openAIChat()">
                <span>ğŸ—¨ï¸ AIå¯¹è¯</span>
            </button>
            <button class="menu-item" onclick="openUpload()">
                <span>ğŸ“¤ ä¸Šä¼ æ–‡ä»¶</span>
            </button>
            <button class="menu-item" onclick="openSettings()">
                <span>âš™ï¸ è®¾ç½®</span>
            </button>
        </div>
        <!-- ç™»å½•çŠ¶æ€ -->
        <div class="user-menu" onmouseleave="hideLogout()">
            <div class="user-info" onmouseenter="showLogout()">
                <span class="username">admin</span>
                <span class="user-icon">ğŸ‘¤</span>
            </div>
            <div class="logout-panel">
                <button class="logout-btn" onclick="logout()">ç™»å‡ºç³»ç»Ÿ</button>
            </div>
        </div>
    </div>
    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="è¾“å…¥æœç´¢å…³é”®è¯...">
        <select id="fileType">
            <option value="all">å…¨éƒ¨ç±»å‹</option>
            <option value="text">çº¯æ–‡æœ¬</option>
            <option value="image">å›¾æ–‡</option>
        </select>
    </div>
</header>

<main class="grid-container" id="gridContainer"></main>

<footer class="footer">
    <p>Â© 2024 ç•…æ–‡å…¨ç´¢ Â· æ¢ç´¢ä¼˜è´¨å†…å®¹</p>
</footer>

<!-- æµ®å±‚ç»“æ„ -->
<div class="overlay" id="overlay">
    <div class="modal">
        <div class="modal-header">
            <span>èµ„æºè¯¦æƒ…</span>
            <span class="close-btn" onclick="closeModal()">Ã—</span>
        </div>
        <div class="modal-body" id="modalContent"></div>
        <div class="modal-footer">
            <span class="close-btn" onclick="closeModal()">å…³é—­è¯¦æƒ…</span>
        </div>
    </div>
</div>

<script>
    // å¢å¼ºæ¨¡æ‹Ÿæ•°æ®
    const sampleData = Array.from({length: 12}, (_, i) => ({
        id: i,
        type: Math.random() > 0.5 ? 'text' : 'image',
        title: `æœç´¢ç»“æœ ${i + 1}`,
        content: 'è¿™æ˜¯ä¸€æ®µç¤ºä¾‹å†…å®¹ï¼Œå±•ç¤ºæœç´¢ç»“æœå¡ç‰‡çš„æ–‡å­—æè¿°éƒ¨åˆ†ã€‚',
        image: `https://picsum.photos/300/200?random=${i}`,
        attributes: {
            format: Math.random() > 0.5 ? 'PDF' : 'DOCX',
            size: `${Math.floor(Math.random() * 5000)} KB`,
            author: `ç”¨æˆ·${String.fromCharCode(65 + i)}`,
            created: `2024-0${Math.ceil(Math.random() * 9)}-0${Math.ceil(Math.random() * 9)}`
        },
        paragraphs: Array.from({length: 5}, (_, p) =>
            `è¿™æ˜¯ç¬¬${p + 1}æ®µæ–‡æœ¬å†…å®¹ï¼ŒåŒ…å«ç¤ºä¾‹æ–‡å­—ç”¨äºæ¼”ç¤ºé«˜äº®æ•ˆæœã€‚å…³é”®å†…å®¹å¯èƒ½å‡ºç°åœ¨ä»»æ„ä½ç½®ã€‚`
        )
    }));

    // æ–°å¢äº¤äº’é€»è¾‘
    function showLogout() {
        document.querySelector('.logout-panel').style.display = 'block';
    }

    function hideLogout() {
        document.querySelector('.logout-panel').style.display = 'none';
    }

    function logout() {
        if(confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
            // æ‰§è¡Œç™»å‡ºé€»è¾‘
            window.location.reload();
        }
    }
    // èœå•åŠŸèƒ½å ä½
    function openAIChat() { console.log('æ‰“å¼€AIå¯¹è¯') }
    function openUpload() { console.log('æ‰“å¼€æ–‡ä»¶ä¸Šä¼ ') }
    function openSettings() { console.log('æ‰“å¼€ç³»ç»Ÿè®¾ç½®') }

    // ç”Ÿæˆå¡ç‰‡
    function createCard(data) {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            ${data.type === 'image' ?
                `<img src="${data.image}" class="card-img" alt="${data.title}">` : ''}
            <div class="card-content">
                <h3 class="card-title">${data.title}</h3>
                <p class="card-desc">${data.content}</p>
            </div>
        `;
        card.addEventListener('click', () => showDetail(data.id));
        return card;
    }

    // æ˜¾ç¤ºè¯¦æƒ…æµ®å±‚
    async function showDetail(id) {
        const overlay = document.getElementById('overlay');
        overlay.style.display = 'flex';
        const modalContent = document.getElementById('modalContent');

        // æ¨¡æ‹ŸAPIè¯·æ±‚
        const data = await fetchDetail(id);

        // ç”Ÿæˆé«˜äº®æ–‡æœ¬ï¼ˆç¤ºä¾‹é«˜äº®"ç¤ºä¾‹"å…³é”®è¯ï¼‰
        const highlighted = data.paragraphs.map(p =>
            p.replace(/ç¤ºä¾‹/g, '<span class="highlight">ç¤ºä¾‹</span>')
        );

        modalContent.innerHTML = `
            ${data.type === 'image' ?
                `<img src="${data.image}" class="detail-img" alt="è¯¦æƒ…å›¾ç‰‡">` : ''}
            <div class="attributes-grid">
                ${Object.entries(data.attributes).map(([key, value]) => `
                    <div class="attribute-item">
                        <span>${key}</span>
                        <span>${value}</span>
                    </div>
                `).join('')}
            </div>
            <div class="btn-group">
                <button class="btn">ä¸‹è½½</button>
                <button class="btn">æŸ¥çœ‹</button>
                <button class="btn btn-delete">åˆ é™¤</button>
                <button class="btn">ç›®å½•</button>
            </div>
            <div class="paragraph-list">
                ${highlighted.map(p => `
                    <div class="paragraph-item">${p}</div>
                `).join('')}
            </div>
        `;

        overlay.style.display = 'flex';

        // æ·»åŠ åˆ é™¤ç¡®è®¤é€»è¾‘
          const deleteBtn = modalContent.querySelector('.btn-delete');
          deleteBtn.addEventListener('click', async () => {
              const confirmDelete = confirm('ç¡®å®šè¦åˆ é™¤è¯¥å†…å®¹å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼');
              if (confirmDelete) {
                  try {
                      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                      deleteBtn.innerHTML = 'åˆ é™¤ä¸­...';
                      deleteBtn.disabled = true;

                      // æ¨¡æ‹Ÿæ¥å£è¯·æ±‚
                      await new Promise(resolve => setTimeout(resolve, 800));

                      // ä»DOMç§»é™¤å¯¹åº”å¡ç‰‡
                      const card = document.querySelector(`[data-id="${data.id}"]`);
                      if (card) card.remove();

                      // å…³é—­æµ®å±‚
                      closeModal();
                      alert('åˆ é™¤æˆåŠŸï¼');
                  } catch (error) {
                      alert('åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•');
                      deleteBtn.innerHTML = 'åˆ é™¤';
                      deleteBtn.disabled = false;
                  }
              }
          });

    }

    // æ¨¡æ‹Ÿæ¥å£è¯·æ±‚
    function fetchDetail(id) {
        return new Promise(resolve => {
            setTimeout(() => {
                resolve(sampleData.find(item => item.id === id));
            }, 300);
        });
    }

    // ä¿®æ”¹æµ®å±‚å…³é—­é€»è¾‘
    function closeModal() {
        const modal = document.querySelector('.modal');
        modal.classList.add('modal-out');
        setTimeout(() => {
            document.getElementById('overlay').style.display = 'none';
            modal.classList.remove('modal-out');
        }, 200);
    }

    // ç‚¹å‡»å¤–éƒ¨å…³é—­
    document.getElementById('overlay').addEventListener('click', (e) => {
        if (e.target === document.getElementById('overlay')) {
            closeModal();
        }
    });

    // åˆå§‹åŠ è½½
    function loadItems() {
        sampleData.forEach(data => {
            gridContainer.appendChild(createCard(data));
        });
    }

    // æœç´¢åŠŸèƒ½
    document.getElementById('searchInput').addEventListener('keyup', (e) => {
        if(e.key === 'Enter') {
            console.log('æ‰§è¡Œæœç´¢:', e.target.value);
        }
    });

    // æ»šåŠ¨åŠ è½½
    let loading = false;
    window.addEventListener('scroll', () => {
        const { scrollTop, clientHeight, scrollHeight } = document.documentElement;
        if (scrollTop + clientHeight >= scrollHeight - 100 && !loading) {
            loading = true;
            setTimeout(() => {
                loadItems();
                loading = false;
            }, 1000);
        }
    });

    // åˆå§‹åŒ–
    loadItems();

    // æ·»åŠ æ»šåŠ¨è¡Œä¸ºæ§åˆ¶
    let lastScroll = 0;

    function handleScroll() {

        const currentScroll = window.pageYOffset;
        const searchBar = document.querySelector('.search-bar');

        if (currentScroll > lastScroll && currentScroll > 300) {
            searchBar.classList.add('hidden');
        } else {
            searchBar.classList.remove('hidden');
        }
        lastScroll = currentScroll;
    }

    // ä¼˜åŒ–æ»šåŠ¨ç›‘å¬
    const throttledScroll = throttle(handleScroll, 500);
    window.addEventListener('scroll', throttledScroll);

    // ç°æœ‰èŠ‚æµå‡½æ•°å¤ç”¨
    function throttle(fn, delay) {
        let lastCall = 0;
        return function(...args) {
            const now = Date.now();
            if (now - lastCall >= delay) {
                lastCall = now;
                fn.apply(this, args);
            }
        }
    }

</script>
</body>
</html>