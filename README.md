<div align="center">

<h1>xyz-searchğŸ‘‹</h1>

[![License](https://img.shields.io/badge/license-GPL%203.0-blue.svg?style=flat-square)](https://www.gnu.org/licenses/gpl-3.0.html)
[![Docker Pulls](https://img.shields.io/docker/pulls/noogel/xyz-search.svg?style=flat-square)](https://hub.docker.com/r/noogel/xyz-search)
[![Version](https://img.shields.io/badge/version-1.2.2-blue.svg?style=flat-square)](https://github.com/noogel/xyz-search/releases)

**æ–°ä¸€ä»£æ™ºèƒ½æ–‡æ¡£æ£€ç´¢ç³»ç»Ÿ | è®©çŸ¥è¯†ç®¡ç†æ›´é«˜æ•ˆã€æ›´æ™ºèƒ½**
</div>

## ğŸ“š ç›®å½•

* [ğŸ’¡ é¡¹ç›®ä»‹ç»](#-é¡¹ç›®ä»‹ç»)
* [âœ¨ ä¸»è¦ç‰¹æ€§](#-ä¸»è¦ç‰¹æ€§)
* [ğŸ” ç³»ç»Ÿæ¶æ„](#-ç³»ç»Ÿæ¶æ„)
* [ğŸš€ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
* [ğŸ”§ é…ç½®è¯´æ˜](#-é…ç½®è¯´æ˜)
* [ğŸ³ Dockeréƒ¨ç½²](#-dockeréƒ¨ç½²)
* [ğŸ“Š å¼€å‘è®¡åˆ’](#-å¼€å‘è®¡åˆ’)
* [ğŸ’¬ å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)
* [ğŸ‘¥ è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)
* [ğŸ“„ è®¸å¯è¯](#-è®¸å¯è¯)

## ğŸ’¡ é¡¹ç›®ä»‹ç»

ç•…æ–‡å…¨ç´¢æ˜¯ä¸€ä¸ªæ™ºèƒ½åŒ–å…¨æ–‡æ£€ç´¢ç³»ç»Ÿã€‚åŸºäºSpring Bootå’ŒLuceneè®¾è®¡ï¼Œæ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼çš„å…¨æ–‡å†…å®¹æ£€ç´¢ï¼Œé€šè¿‡é›†æˆSpring AIåŠŸèƒ½ï¼Œæ”¯æŒæ™ºèƒ½æœç´¢å’Œå†…å®¹åˆ†æï¼Œä¸ºç”¨æˆ·æä¾›æ›´ç²¾å‡†çš„æœç´¢ä½“éªŒã€‚

æœ¬ç³»ç»Ÿä¸“ä¸ºä¸ªäººçŸ¥è¯†ç®¡ç†å’Œæ•°å­—å›¾ä¹¦é¦†è€Œè®¾è®¡ï¼Œå¯ä»¥è½»æ¾å¤„ç†ä»å‡ åƒåˆ°æ•°åä¸‡çš„æ–‡æ¡£é›†åˆã€‚æ— è®ºæ˜¯ç®¡ç†ä¸ªäººç”µå­ä¹¦åº“ï¼Œè¿˜æ˜¯æ„å»ºä¼ä¸šçº§æ–‡æ¡£æ£€ç´¢å¹³å°ï¼Œç•…æ–‡å…¨ç´¢éƒ½èƒ½æ»¡è¶³æ‚¨çš„éœ€æ±‚ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

### ğŸ“„ å¤šæ ¼å¼æ–‡æ¡£æ”¯æŒ

* å…¨é¢æ”¯æŒåŠå…¬æ–‡æ¡£ï¼šPDFã€Wordã€Excelã€PowerPoint
* ä¸“ä¸šçš„ç”µå­ä¹¦å¤„ç†ï¼šæ”¯æŒ EPUB æ ¼å¼çš„å†…å®¹è§£æå’Œç´¢å¼•
* æ™ºèƒ½å›¾åƒè¯†åˆ«ï¼šåŸºäº PaddleOCR çš„å›¾ç‰‡æ–‡å­—æå–
* å¤šåª’ä½“æ”¯æŒï¼šè§†é¢‘å…ƒæ•°æ®ç´¢å¼•å’Œé¢„è§ˆåŠŸèƒ½
* ç½‘é¡µå’Œæ–‡æœ¬ï¼šæ”¯æŒ HTML å’Œçº¯æ–‡æœ¬æ–‡ä»¶çš„è§£æ

### ğŸ” é«˜æ€§èƒ½æœç´¢å¼•æ“

* åŸºäº Lucene çš„åˆ†å¸ƒå¼ç´¢å¼•æ¶æ„
* ä¸“ä¸šçš„ä¸­æ–‡åˆ†è¯ç®—æ³•
* å®æ—¶ç´¢å¼•æ›´æ–°æœºåˆ¶
* ç²¾ç¡®çš„æ–‡ä»¶å±æ€§è¿‡æ»¤
* æ™ºèƒ½åŒ–æœç´¢ç»“æœé«˜äº®

### ğŸ¤– AI å¢å¼ºåŠŸèƒ½

* é›†æˆ Spring AI æ¡†æ¶
* åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„å†…å®¹ç†è§£
* è‡ªç„¶è¯­è¨€å¯¹è¯å¼æ£€ç´¢
* æ”¯æŒæœ¬åœ°éƒ¨ç½² Ollama æ¨¡å‹
* æ™ºèƒ½æ–‡æ¡£æ‘˜è¦ç”Ÿæˆ

### ğŸ“š ç”µå­ä¹¦ç®¡ç†

* å®Œæ•´æ”¯æŒ OPDS ç”µå­ä¹¦åè®®
* åœ¨çº¿ EPUB é˜…è¯»å™¨
* å…¨é¢å…¼å®¹ä¸»æµé˜…è¯»è®¾å¤‡
* æ™ºèƒ½å°é¢å’Œç›®å½•ç´¢å¼•
* ä¸ªæ€§åŒ–é˜…è¯»ä½“éªŒ

### ğŸ’» ç°ä»£åŒ–ç•Œé¢è®¾è®¡

* ç®€æ´ä¼˜é›…çš„ Web äº¤äº’ç•Œé¢
* ä¾¿æ·çš„æ–‡æ¡£ä¸Šä¼ åŠŸèƒ½
* æ™ºèƒ½æ–‡ä»¶è‡ªåŠ¨é‡‡é›†
* å“åº”å¼ç§»åŠ¨ç«¯é€‚é…
* ä¸°å¯Œçš„æ–‡æ¡£é¢„è§ˆåŠŸèƒ½

## ğŸ” ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                â”‚      â”‚                â”‚     â”‚                â”‚
â”‚   Web ç•Œé¢      â”‚      â”‚  RESTful API   â”‚     â”‚    OPDSåè®®    â”‚
â”‚                â”‚      â”‚                â”‚     â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Spring Boot                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                â”‚                â”‚                â”‚             â”‚
â”‚    æœç´¢æœåŠ¡     â”‚     ç´¢å¼•æœåŠ¡     â”‚     AIæœåŠ¡     â”‚   æ–‡ä»¶æœåŠ¡    â”‚
â”‚                â”‚                â”‚                â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                 â”‚           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚               â”‚    â”‚              â”‚   â”‚            â”‚    â”‚
â”‚     Lucene    â”‚    â”‚   SQLite     â”‚   â”‚ Spring AI  â”‚    â”‚
â”‚               â”‚    â”‚              â”‚   â”‚            â”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                                                          â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
                       â”‚                            â”‚     â”‚
                       â”‚         æ–‡ä»¶å­˜å‚¨            â—„â”€â”€â”€â”€â”€â”˜
                       â”‚                            â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨é¢„æ„å»ºé•œåƒ

```bash
# åˆ›å»ºå®¹å™¨ç½‘ç»œ
docker network create -d bridge xyz-bridge-net

# æ‹‰å–å®˜æ–¹é•œåƒ
docker pull noogel/xyz-search:latest

# å¯åŠ¨æœåŠ¡å®¹å™¨
docker run -d --name xyzSearch --network xyz-bridge-net -p 8081:8081 \
-v /path/to/searchData:/usr/share/xyz-search/data \
-v /path/to/share:/data/share \
noogel/xyz-search:latest
```

> ç³»ç»Ÿé»˜è®¤é…ç½®ï¼š
>
> * ç®¡ç†å‘˜è´¦å·ï¼šxyz
> * åˆå§‹å¯†ç ï¼šsearch
> * è®¿é—®åœ°å€ï¼š<http://localhost:8081>
> * æ³¨ï¼šå¯†ç å¯åœ¨ç³»ç»Ÿé…ç½®é¡µé¢ä¿®æ”¹ï¼Œè´¦å·æš‚ä¸æ”¯æŒä¿®æ”¹ã€‚ç™»å½•å®‰å…¨æ€§æœ‰å¾…éªŒè¯ï¼Œå»ºè®®å†…ç½‘ä½¿ç”¨ã€‚

## ğŸ”§ é…ç½®è¯´æ˜

ç³»ç»Ÿå¯åŠ¨åï¼Œå¯åœ¨ Web ç•Œé¢é…ç½®ä»¥ä¸‹å‚æ•°ï¼š

```json5
{
  "indexDirectories": [
    {
      // æ–‡æ¡£ç´¢å¼•ä¸»ç›®å½•ï¼Œæ”¯æŒé…ç½®å¤šä¸ª
      "directory": "/homes/xxx/XyzSearchTestData",
      "excludesDirectories": [
        // éœ€è¦æ’é™¤çš„å­ç›®å½•ï¼Œå¿…é¡»ä½äºä¸»ç›®å½•ä¸‹
        "/homes/xxx/XyzSearchTestData/exclude"
      ],
      // æ’é™¤ç‰¹å®šç±»å‹æ–‡ä»¶çš„å¤„ç†å™¨
      "excludeFileProcessClass": []
    }
  ],
  // æ–‡ä»¶è‡ªåŠ¨é‡‡é›†é…ç½®
  "collectDirectories": [
    {
      "fromList": [
        // ç›‘æ§çš„æºç›®å½•ï¼Œæ”¯æŒå¤šä¸ª
        "/Users/xyz/Downloads/collect"
      ],
      // æ–‡ä»¶å­˜å‚¨ç›®æ ‡ç›®å½•
      "to": "/homes/xxx/XyzSearchTestData/collect",
      // æ–‡ä»¶ç±»å‹è¿‡æ»¤æ­£åˆ™è¡¨è¾¾å¼
      "filterRegex": "\\.(pdf|PDF|epub|EPUB|docx|DOCX)",
      // é‡‡é›†åæ˜¯å¦è‡ªåŠ¨åˆ é™¤æºæ–‡ä»¶
      "autoDelete": true
    }
  ],
  // OPDS æœåŠ¡æ ¹ç›®å½•ï¼Œæ¨èä½¿ç”¨ Calibre åº“ç›®å½•
  "opdsDirectory": "/homes/xxx/XyzSearchTestData",
  // æ‰‹åŠ¨ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨ç›®å½•
  "uploadFileDirectory": "/homes/xxx/XyzSearchTestData/upload",
  // æ ‡è®°åˆ é™¤æ–‡ä»¶çš„ä¸´æ—¶å­˜å‚¨ç›®å½•
  "markDeleteDirectory": "/homes/xxx/XyzSearchTestData/exclude/deleted",
  // ç³»ç»Ÿè®¿é—®é€šçŸ¥é‚®ä»¶é…ç½®
  "notifyEmail": {
    "senderEmail": null,
    "emailHost": null,
    "emailPort": null,
    "emailPass": null,
    "receivers": []
  },
  // OCR æœåŠ¡é…ç½®
  "paddleOcr": {
    "url": null,
    "timeout": 10000
  },
  // æ–‡æ¡£è¯¦æƒ…é¡µçš„å¤–éƒ¨æœç´¢é“¾æ¥
  "linkItems": [
    {
      "desc": "è±†ç“£",
      "searchUrl": "https://m.douban.com/search/?query={query}"
    },
    {
      "desc": "äº¬ä¸œ",
      "searchUrl": "https://so.m.jd.com/ware/search.action?keyword={query}"
    },
    {
      "desc": "è°·æ­Œ",
      "searchUrl": "https://www.google.com/search?q={query}"
    }
  ],
  // AI å¯¹è¯æ£€ç´¢é…ç½®
  "chat": {
    "enable": false,
    "ollama": {
      "baseUrl": "http://192.168.124.101:11434",
      "chatModel": "deepseek-r1:1.5b",
      "chatOptionNumCtx": "4096",
      "chatOptionTemperature": "1.0",
      "chatOptionNumPredict": "10000",
      "embeddingAdditionalModels": [],
      "pullModelStrategy": "when_missing"
    },
    // å¯é€‰çš„å…¨æ–‡ç´¢å¼•
    "elastic": {
      "enable": true,
      "host": "http://192.168.124.13:9200",
      "username": null,
      "password": null,
      "caPath": null,
      "connectionTimeout": 10000,
      "socketTimeout": 30000,
      "highlightMaxAnalyzedOffset": 10000001
    },
    // å‘é‡æ•°æ®åº“ï¼Œå¯é€‰ï¼Œå¢å¼ºæ£€ç´¢
    "qdrant": {
      "enable": false,
      "host": "192.168.124.13",
      "port": 6334,
      "apiKey": "xEYepb9JSXjSauW2"
    }
  }
}
```

## ğŸ³ Dockeréƒ¨ç½²

### æ„å»ºæœ¬åœ°é•œåƒ

> ç¯å¢ƒè¦æ±‚ï¼šJDK 17 æˆ–æ›´é«˜ç‰ˆæœ¬

```bash
# æ„å»ºé•œåƒ
mvn clean package && cd docker && docker build -t xyz-search:latest . && \
docker tag xyz-search:latest ç”¨æˆ·å/xyz-search:latest && cd ../../

# æ¨é€åˆ°é•œåƒä»“åº“
docker push ç”¨æˆ·å/xyz-search:latest

# åˆ›å»ºå®¹å™¨ç½‘ç»œ
docker network create -d bridge xyz-bridge-net

# éƒ¨ç½²æœåŠ¡
docker run -d --restart=always --name xyzSearch --network xyz-bridge-net -p 8081:8081 \
-v /å®é™…è·¯å¾„/searchData:/usr/share/xyz-search/data \
-v /å®é™…è·¯å¾„/share:/data/share \
ç”¨æˆ·å/xyz-search:latest
```

### ä½¿ç”¨ Docker Compose éƒ¨ç½²

åˆ›å»º `docker-compose.yml` é…ç½®æ–‡ä»¶ï¼š

```yaml
version: '3'
services:
  xyz-search:
    image: noogel/xyz-search:latest
    container_name: xyzSearch
    restart: always
    ports:
      - "8081:8081"
    volumes:
      - ./searchData:/usr/share/xyz-search/data
      - ./share:/data/share
    networks:
      - xyz-net

networks:
  xyz-net:
    driver: bridge
```

æ‰§è¡Œéƒ¨ç½²å‘½ä»¤ï¼š

```bash
docker-compose up -d
```

### å®Œæ•´é…ç½®

```yaml
services:
  search:
    container_name: search
    environment:
      - PUID=3000
      - PGID=3000
      - TZ=Asia/Shanghai
      - INIT_MODE=full
    image: noogel/xyz-search:latest
    depends_on:
      - elastic
      - qdrant
      - paddleocr
    ports:
      - '8081:8081'
    restart: unless-stopped
    volumes:
      - ./docker/search/data:/data/share
      - ./docker/search/config:/usr/share/xyz-search/data
  elastic:
    container_name: elastic
    environment:
      - PUID=3000
      - PGID=3000
      - TZ=Asia/Shanghai
      - xpack.security.enabled=false
      - discovery.type=single-node
      - ES_JAVA_OPTS=-Xms1g -Xmx2g
    image: noogel/elasticsearch:8.17.4-alpha
    restart: unless-stopped
    volumes:
      - ./docker/search/es:/usr/share/elasticsearch/data
  qdrant:
    container_name: qdrant
    image: qdrant/qdrant:latest
    volumes:
      - ./docker/search/qdrant:/qdrant/storage
    environment:
      QDRANT__SERVICE__API_KEY: "3Yptaw9Z8ELMEsqp"
    restart: unless-stopped
  paddleocr:
    image: 'noogel/paddleocr:cpu-pp-ocrv4-server'
    restart: unless-stopped
    container_name: paddleocr
    deploy:
      resources:
        limits:
          memory: 6G
        reservations:
          memory: 500M
```

## ğŸ’¬ å¸¸è§é—®é¢˜

**Q: å¦‚ä½•ä¿®æ”¹ç³»ç»Ÿé»˜è®¤ç«¯å£ï¼Ÿ**
A: å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼ä¿®æ”¹ï¼š

1. åœ¨ `application.yml` ä¸­ä¿®æ”¹ `server.port` é…ç½®é¡¹
2. å¯åŠ¨æ—¶æ·»åŠ å‚æ•°ï¼š`--server.port=æ–°ç«¯å£å·`

**Q: æ”¯æŒå“ªäº›æ–‡æ¡£æ ¼å¼ï¼Ÿ**
A: ç³»ç»Ÿæ”¯æŒä»¥ä¸‹æ ¼å¼ï¼š

* åŠå…¬æ–‡æ¡£ï¼šPDFã€Word (docx)ã€Excel (xlsx)
* ç”µå­ä¹¦ï¼šEPUBã€MOBI
* å›¾ç‰‡ï¼šPNGã€JPGã€JPEG (æ”¯æŒ OCR)
* ç½‘é¡µï¼šHTMLã€HTM
* æ–‡æœ¬ï¼šTXTã€MDã€JSON ç­‰çº¯æ–‡æœ¬æ ¼å¼

**Q: å¦‚ä½•æå‡æœç´¢æ€§èƒ½ï¼Ÿ**
A: å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–ï¼š

1. åˆç†é…ç½®ç´¢å¼•ç›®å½•ï¼Œé¿å…ç´¢å¼•æ— å…³æ–‡ä»¶
2. ä½¿ç”¨ SSD å­˜å‚¨ç´¢å¼•æ–‡ä»¶
3. é€‚å½“è°ƒæ•´ JVM å†…å­˜å‚æ•°
4. å¯ç”¨æ–‡ä»¶ç±»å‹è¿‡æ»¤

## ğŸ“Š å¼€å‘è®¡åˆ’

* [ x ] ä¼˜åŒ– RAG æ£€ç´¢å¢å¼ºç”Ÿæˆæ¨¡å‹
* [ x ] æ”¹è¿›ä¸­æ–‡åˆ†è¯å‡†ç¡®ç‡
* [ ] å…¨æ–°çš„å“åº”å¼æœç´¢ç•Œé¢
* [ ] å®ç°å¤šç”¨æˆ·ç³»ç»Ÿ
* [ ] æ”¯æŒæ›´å¤šæ–‡æ¡£æ ¼å¼

## ğŸ‘¥ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š

* åŠŸèƒ½å¼€å‘ä¸æ”¹è¿›
* æ–‡æ¡£å®Œå–„
* Bug ä¿®å¤
* æµ‹è¯•ç”¨ä¾‹ç¼–å†™
* æ€§èƒ½ä¼˜åŒ–å»ºè®®

å‚ä¸è´¡çŒ®æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼š`git checkout -b feature/AmazingFeature`
3. æäº¤æ”¹åŠ¨ï¼š`git commit -m 'Add some AmazingFeature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/AmazingFeature`
5. æäº¤ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [GNU General Public License v3.0](https://www.gnu.org/licenses/gpl-3.0.html) è®¸å¯è¯
